<?php

/**
 * @file
 * Install, update and uninstall hooks for the communications subprofile.
 */

use Drupal\Core\Entity\Entity\EntityViewDisplay;
use Drupal\field\Entity\FieldConfig;
use Drupal\user\Entity\User;
use Drupal\user\RoleInterface;

/**
 * Implements hook_install().
 */
function communications_install() {
    // Can add code in here to make nodes, terms, etc.
  $modules = [
    'communications_media_entity_image',
    'communications_person',
    'communications_test'
  ];

  foreach ($modules as $module) {
    \Drupal::service('module_installer')->install([$module]);
  }

  $stinky_modules = [
    'stark',
    'bartik',
  ];

  foreach ($stinky_modules as $module) {
    \Drupal::service('module_installer')->uninstall([$module]);
  }

  // Set the default and admin theme.
  \Drupal::configFactory()
    ->getEditable('system.theme')
    ->set('default', 'nrel_bootstrap')
    ->set('admin', 'seven')
    ->save(TRUE);

  // Enable the admin theme.
  \Drupal::configFactory()
    ->getEditable('node.settings')
    ->set('use_admin_theme', TRUE)
    ->save(TRUE);

  // Assign user 1 the "developer" role.
  $user = User::load(1);
  $user->roles[] = 'developer';
  $user->save();

  // Create accounts for The Developer team.
  $user_add = \Drupal\user\Entity\User::create();
  $user_add->setUsername('dhaley');
  $user_add->setEmail('damon.haley@nrel.gov');
  $user_add->setPassword(user_password());
  $user_add->enforceIsNew();
  $user_add->activate();
  $user_add->roles[] = 'developer';
  $res = $user_add->save();

  $user_add = \Drupal\user\Entity\User::create();
  $user_add->setUsername('slaws');
  $user_add->setEmail('shaun.laws@nrel.gov');
  $user_add->setPassword(user_password());
  $user_add->enforceIsNew();
  $user_add->activate();
  $user_add->roles[] = 'developer';
  $res = $user_add->save();

  $user_add = \Drupal\user\Entity\User::create();
  $user_add->setUsername('SThew');
  $user_add->setEmail('Steven.Thew@nrel.gov');
  $user_add->setPassword(user_password());
  $user_add->enforceIsNew();
  $user_add->activate();
  $user_add->roles[] = 'developer';
  $res = $user_add->save();

  $user_add = \Drupal\user\Entity\User::create();
  $user_add->setUsername('sfjeld');
  $user_add->setEmail('Shauna.Fjeld@nrel.gov');
  $user_add->setPassword(user_password());
  $user_add->enforceIsNew();
  $user_add->activate();
  $user_add->roles[] = 'administrator';
  $res = $user_add->save();


}
